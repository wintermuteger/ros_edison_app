<!DOCTYPE html>
<!--HTML5 doctype-->
<html>

<head>

    <title>Tab View Template</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <META HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" type="text/css" href="../www/appframework/build/icons.css" />
    <link rel="stylesheet" type="text/css" href="../www/appframework/build/af.ui.css" />

    <script type="text/javascript" charset="utf-8" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="http://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.3/fastclick.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="../www/appframework/build/appframework.ui.js"></script>
    <script type="text/javascript" src="http://cdn.robotwebtools.org/EventEmitter2/0.4.14/eventemitter2.js"></script>
    <script type="text/javascript" src="http://cdn.robotwebtools.org/roslibjs/current/roslib.js"></script>
    <!--<script type="text/javascript" charset="utf-8" src="../www/js/ROS_Touchpad.js"></script>-->
    <script type="text/javascript" charset="utf-8" src="../www/js/ROS_Gamepad.js"></script>
    <script type="text/javascript" charset="utf-8" src="../www/js/ROS_Edison.js"></script>
    <script>
    
    var ros_edison = new ROS_Edison({ip_string: "192.168.178.40", port_string: "9090"});
    
    //var ros_touchpad = new ROS_Touchpad();
        
    //---------------------------------
    //Main jQuery entry point (after loading)
    //---------------------------------
    $(function() 
    {
        //Reset strings
        $("#app-status").html("<b>Status:</b> No robot configured");
        $("#vbat").html("VBAT: --V");
        $("#cpuload").html("CPU load: --%s");
        //Check if tilting is available
        if (window.DeviceOrientationEvent) 
        {
            $("#tiltstatus").text('Tilt control supported! Move device to activate!');
            window.addEventListener('deviceorientation', activateTilt, false);
        }
        else
        {
            $("#tiltstatus").css('display', 'none');
        }
        //Set callback which will deactivate e.g. the tilt, when being called
        ros_gamepad.onConnectCallback = activateGamepad;
        //Configure div of gamepad for display
        ros_gamepad.$div = $("#gamepadstatus");
        //Connect ROS Object
        ros_edison.connect();
        //Setup Touchpad
        //ros_touchpad.setup($("#touchpad"));
    });
        
    function activateTilt(event)
    {
        ros_gamepad.disableGamepadSupport();
        $("#tiltstatus").text("Tilt active! gamma=" +event.gamma + ";beta="+event.beta+";alpha="+event.alpha);
    }
        
    function activateGamepad()
    {
        $("#tiltstatus").css("display", "none");
    }
        
    </script>
</head>

<body>

    <div id="splashscreen" class='ui-loader heavy'>
        App Framework - Tab View
        <br>
        <br>
        <span class='ui-icon ui-icon-loading spin'></span>
        <h1>Starting app</h1>
    </div>

    <div class="view" id="mainview">
        <header>
            <h1>Tab View</h1>
        </header>

        <div class="pages">

         <!--Tab View Pages-->
        <div class="panel" data-title="Home" id="main-panel" data-selected="true">
            <center><div id="app-status"></div></center>
            <center><div id="vbat"></div></center>
            <center><div id="cpuload"></div></center>
            <center><div id="camera"><canvas width="320" height="240" id="camcan"></canvas></div>
            </center>
            <center><div id="gamepadstatus">No gamepad connected! Press any button to activate!</div></center>
            <!--<center><div id="touchpad" style="width:300px; height:300px">touch</div></center>-->
            <center><div id="tiltstatus">Tilt detection...</div></center>
        </div>

        <div class="panel" data-title="Favorites" id="settings-panel" >
            This is view for second Tab
            <br>
            <br>
             <a href="#about-panel" class="button" data-tab='tab3' data-transition="slide-left">About</a>
        </div>

        <div class="panel" data-title="Messages" id="about-panel">
            <h1>ROS Edison App</h1>
            <p>Copyright 2015-2016, Christoph Schultz</p>
            <p>App for connecting to a robot on an Intel Edison platform running ROS.
            The rosbridge module has to be active.</p>
        </div>

        </div>

        <footer>
            <a href="#main-panel" class="icon home" id='tab1' >Main</a>
            <a href="#settings-panel" class="icon settings" id='tab2' data-transition="up-reveal">Settings</a>
            <a href="#about-panel" class="icon info" id='tab3' data-transition="slide-left">About</a>
        </footer>
    </div>


</body>

</html>